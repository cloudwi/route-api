---
openapi: 3.0.1
info:
  title: Route API
  version: v1
  description: 장소 검색 및 관리 API
paths:
  "/api/v1/external/search":
    get:
      summary: 외부 장소 검색
      tags:
      - 외부 장소 검색
      description: 네이버 로컬 검색 API를 통해 장소를 검색합니다
      parameters:
      - name: query
        in: query
        required: true
        description: '검색 키워드 (예: 스타벅스 강남역)'
        schema:
          type: string
      - name: display
        in: query
        required: false
        description: '검색 결과 개수 (1-5, 기본값: 5)'
        schema:
          type: integer
      responses:
        '200':
          description: 검색 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  query:
                    type: string
                    description: 검색한 키워드
                  count:
                    type: integer
                    description: 검색 결과 개수
                  places:
                    type: array
                    items:
                      type: object
                      properties:
                        title:
                          type: string
                          description: 장소명
                        address:
                          type: string
                          description: 지번 주소
                        road_address:
                          type: string
                          description: 도로명 주소
                        category:
                          type: string
                          description: 카테고리
                        description:
                          type: string
                          description: 설명
                        telephone:
                          type: string
                          description: 전화번호
                        latitude:
                          type: number
                          format: float
                          description: 위도 (WGS84)
                        longitude:
                          type: number
                          format: float
                          description: 경도 (WGS84)
                        naver_map_url:
                          type: string
                          description: 네이버 지도 URL
                required:
                - query
                - count
                - places
        '400':
          description: 검색어 누락
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
  "/api/v1/my_search":
    get:
      summary: 내부 장소 검색
      tags:
      - 검색
      description: 저장된 장소를 검색합니다
      parameters:
      - name: q
        in: query
        required: false
        description: 검색 키워드
        schema:
          type: string
      - name: category
        in: query
        required: false
        description: 카테고리 필터 (장소 검색에만 적용)
        schema:
          type: string
      - name: type
        in: query
        required: false
        enum:
        - places
        description: "검색 타입:\n * `places` - 장소만 검색\n "
        schema:
          type: string
      - name: limit
        in: query
        required: false
        description: '결과 개수 제한 (1-100, 기본값: 20)'
        schema:
          type: integer
      responses:
        '200':
          description: 검색 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  places:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 내부 장소 ID
                        naverPlaceId:
                          type: string
                          description: 네이버 장소 ID
                        name:
                          type: string
                          description: 장소명
                        address:
                          type: string
                          description: 지번 주소
                        roadAddress:
                          type: string
                          description: 도로명 주소
                        lat:
                          type: number
                          description: 위도
                        lng:
                          type: number
                          description: 경도
                        category:
                          type: string
                          description: 카테고리
                        telephone:
                          type: string
                          description: 전화번호
                        naverMapUrl:
                          type: string
                          description: 네이버 지도 URL
                        viewsCount:
                          type: integer
                          description: 조회수
                        likesCount:
                          type: integer
                          description: 좋아요 수
                        createdAt:
                          type: string
                          format: date-time
                          description: 생성일시
  "/api/v1/my_search/categories":
    get:
      summary: 카테고리 목록 조회
      tags:
      - 검색
      description: 사용 가능한 장소 카테고리 목록을 조회합니다
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  categories:
                    type: array
                    items:
                      type: string
                    description: 카테고리 목록
                required:
                - categories
  "/api/v1/places":
    get:
      summary: 장소 목록 조회
      tags:
      - 장소
      description: 현재 로그인한 사용자의 장소 목록을 조회합니다
      security:
      - bearer_auth: []
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: 내부 장소 ID
                    naverPlaceId:
                      type: string
                      description: 네이버 장소 ID
                    name:
                      type: string
                      description: 장소명
                    address:
                      type: string
                      description: 지번 주소
                    roadAddress:
                      type: string
                      description: 도로명 주소
                    lat:
                      type: number
                      description: 위도
                    lng:
                      type: number
                      description: 경도
                    category:
                      type: string
                      description: 카테고리
                    telephone:
                      type: string
                      description: 전화번호
                    naverMapUrl:
                      type: string
                      description: 네이버 지도 URL
                    viewsCount:
                      type: integer
                      description: 조회수
                    likesCount:
                      type: integer
                      description: 좋아요 수
                    liked:
                      type: boolean
                      description: 좋아요 여부
                    createdAt:
                      type: string
                      format: date-time
                      description: 생성일시
        '401':
          description: 인증 실패
  "/api/v1/places/liked":
    get:
      summary: 좋아요한 장소 목록
      tags:
      - 장소
      description: 현재 사용자가 좋아요한 장소 목록을 조회합니다
      security:
      - bearer_auth: []
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    naverPlaceId:
                      type: string
                    name:
                      type: string
                    address:
                      type: string
                    roadAddress:
                      type: string
                    lat:
                      type: number
                    lng:
                      type: number
                    category:
                      type: string
                    telephone:
                      type: string
                    naverMapUrl:
                      type: string
                    viewsCount:
                      type: integer
                    likesCount:
                      type: integer
                    liked:
                      type: boolean
                    createdAt:
                      type: string
                      format: date-time
        '401':
          description: 인증 실패
  "/api/v1/places/{id}":
    parameters:
    - name: id
      in: path
      description: 장소 ID
      required: true
      schema:
        type: integer
    get:
      summary: 장소 상세 조회
      tags:
      - 장소
      description: 특정 장소의 상세 정보를 조회합니다 (조회수 증가)
      security:
      - bearer_auth: []
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  naverPlaceId:
                    type: string
                    nullable: true
                  name:
                    type: string
                  address:
                    type: string
                  roadAddress:
                    type: string
                    nullable: true
                  lat:
                    type: number
                  lng:
                    type: number
                  category:
                    type: string
                    nullable: true
                  telephone:
                    type: string
                    nullable: true
                  naverMapUrl:
                    type: string
                    nullable: true
                  viewsCount:
                    type: integer
                  likesCount:
                    type: integer
                  liked:
                    type: boolean
                  createdAt:
                    type: string
                    format: date-time
        '404':
          description: 장소 없음
        '401':
          description: 인증 실패
  "/api/v1/places/{place_id}/likes":
    parameters:
    - name: place_id
      in: path
      description: 장소 ID
      required: true
      schema:
        type: integer
    post:
      summary: 좋아요 토글
      tags:
      - 장소
      description: 장소에 좋아요를 추가하거나 취소합니다
      security:
      - bearer_auth: []
      responses:
        '200':
          description: 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: 결과 메시지
                  likes_count:
                    type: integer
                    description: 현재 좋아요 수
                  liked:
                    type: boolean
                    description: 좋아요 상태
        '404':
          description: 장소 없음
        '401':
          description: 인증 실패
  "/api/v1/popular_places":
    get:
      summary: 인기 장소 조회
      tags:
      - 장소
      description: 인기 장소 Top 5를 조회합니다 (조회수 + 좋아요 * 3 기준)
      responses:
        '200':
          description: 조회 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  places:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: 내부 장소 ID
                        naverPlaceId:
                          type: string
                          description: 네이버 장소 ID
                        name:
                          type: string
                          description: 장소명
                        address:
                          type: string
                          description: 지번 주소
                        roadAddress:
                          type: string
                          description: 도로명 주소
                        lat:
                          type: number
                          description: 위도
                        lng:
                          type: number
                          description: 경도
                        category:
                          type: string
                          description: 카테고리
                        telephone:
                          type: string
                          description: 전화번호
                        naverMapUrl:
                          type: string
                          description: 네이버 지도 URL
                        viewsCount:
                          type: integer
                          description: 조회수
                        likesCount:
                          type: integer
                          description: 좋아요 수
                        popularityScore:
                          type: number
                          description: 인기 점수
                        createdAt:
                          type: string
                          format: date-time
                          description: 생성일시
                required:
                - places
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: api.example.com
  description: Production server
components:
  securitySchemes:
    bearer_auth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Place:
      type: object
      properties:
        id:
          type: string
          description: 네이버 장소 ID
        name:
          type: string
          description: 장소명
        address:
          type: string
          description: 지번 주소
        roadAddress:
          type: string
          description: 도로명 주소
        lat:
          type: number
          description: 위도
        lng:
          type: number
          description: 경도
        category:
          type: string
          description: 카테고리
        telephone:
          type: string
          description: 전화번호
        naverMapUrl:
          type: string
          description: 네이버 지도 URL
